"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5522],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>u});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,u=d["".concat(l,".").concat(m)]||d[m]||h[m]||i;return n?a.createElement(u,o(o({ref:t},p),{},{components:n})):a.createElement(u,o({ref:t},p))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2843:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:1},o=void 0,s={unversionedId:"chapter 3/Pre-setting",id:"chapter 3/Pre-setting",title:"Pre-setting",description:"Traffic recording and replay is done by recording your live traffic and then reusing it(replaying) in the testing environment for testing the correctness of code logic.",source:"@site/docs/chapter 3/Pre-setting.md",sourceDirName:"chapter 3",slug:"/chapter 3/Pre-setting",permalink:"/website/docs/chapter 3/Pre-setting",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chapter 3/Pre-setting.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Traffic Replay",permalink:"/website/docs/category/traffic-replay"},next:{title:"Traffic Replay",permalink:"/website/docs/chapter 3/Traffic Replay"}},l={},c=[{value:"Record your appication",id:"record-your-appication",level:2},{value:"AppSetting",id:"appsetting",level:2},{value:"Recording setting",id:"recording-setting",level:3},{value:"Basic setting",id:"basic-setting",level:4},{value:"Advanced setting",id:"advanced-setting",level:4},{value:"Replay setting",id:"replay-setting",level:3},{value:"Configure with Yaml file",id:"configure-with-yaml-file",level:3},{value:"Nodes Ignore",id:"nodes-ignore",level:3},{value:"Nodes Sort",id:"nodes-sort",level:3}],p={toc:c},d="wrapper";function h(e){let{components:t,...i}=e;return(0,r.kt)(d,(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Traffic recording and replay is done by recording your live traffic and then reusing it(replaying) in the testing environment for testing the correctness of code logic."),(0,r.kt)("p",null,"It is often used for regression testing and has a number of advantages:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Through recording traffic, with low cost in creating cases;"),(0,r.kt)("li",{parentName:"ul"},"Perfectly simulating user behavior by replaying real traffic from the production environment, avoiding the discrepancies that may occur from manual writing;"),(0,r.kt)("li",{parentName:"ul"},"Additionally, a more in-depth and fine validation of system logic can be achieved by comparing the recorded data and replayed data in an object-by-object manner;"),(0,r.kt)("li",{parentName:"ul"},"The recorded traffic is readily available for use, and does not require maintenance, making it extremely convenient.")),(0,r.kt)("h2",{id:"record-your-appication"},"Record your appication"),(0,r.kt)("p",null,"AREX Agent is the core component for implementing service recording and playback. To use the recording function, the Agent must be deployed in the tested application, see for ",(0,r.kt)("a",{parentName:"p",href:"/website/docs/chapter1/Quick%20Installation#deploy-arex-agent"},"Deploy AREX Agent"),"."),(0,r.kt)("p",null,"Once configured, you can access the AREX UI through Chrome browser, select the ",(0,r.kt)("strong",{parentName:"p"},"Replay")," tab, and then you will see your applications to be tested in the right-side."),(0,r.kt)("img",{src:"https://i.328888.xyz/2023/02/10/RUoDo.png",alt:"RUoDo.png",width:"400",height:""}),(0,r.kt)("p",null,"By default, AREX automatically records all online traffic, but you can customize recording tasks in ",(0,r.kt)("strong",{parentName:"p"},"AppSetting"),"."),(0,r.kt)("h2",{id:"appsetting"},"AppSetting"),(0,r.kt)("p",null,"Select the ",(0,r.kt)("strong",{parentName:"p"},"AppSetting")," tab in the sidebar. The list shows all the recorded applications. Select one app to set it."),(0,r.kt)("img",{src:"https://i.328888.xyz/2023/02/10/RUJid.png",alt:"RUJid.png",width:"400",height:""}),(0,r.kt)("h3",{id:"recording-setting"},"Recording setting"),(0,r.kt)("p",null,"You can periodic record the live traffic for specific time periods according to your needs. Select ",(0,r.kt)("strong",{parentName:"p"},"Record")," tab to enter the recording settings page."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u5f55\u5236\u8bbe\u7f6e",src:n(4143).Z,width:"3209",height:"1480"})),(0,r.kt)("h4",{id:"basic-setting"},"Basic setting"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Duration"),"\uff1aSelect the day to record the application, you can choose to record every day, or just for any days of the week."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Period"),"\uff1aSelect the time period from 00:00 ~ 24:00 for daily recording."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Frequency"),'\uff1aSelect the recording frequency from "1~100", with a unit of "times/100 seconds", meaning the number of recordings per 100 seconds.'),(0,r.kt)("h4",{id:"advanced-setting"},"Advanced setting"),(0,r.kt)("p",null,"AREX provides a very comprehensive Mock feature. Not only basic dependency data can be mocked, time and local cache type data can also be mocked."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Time Mock"),"\uff1aAs many business systems are time sensitive, different time access will often return different results. In this case, you can select ",(0,r.kt)("strong",{parentName:"p"},"Time Mock"),", and then the time will also be mocked during the recording process, to ensure that the replay results will not be different due to the time."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Dynamic Classes"),'\uff1aIn actual on-line applications, various caches are used to improve runtime performance. To avoid inconsistencies in the execution results caused by differences in cache data, AREX can also collect and mock these local cache data. The implementation method is to configure the method of accessing the local cache as a dynamic class, which is equivalent to customizing the method for mocking. It will record the data of the dynamic class method you configured in the production environment, and playback the corresponding matching data returned. Besides cache data, various memory data can also be mocked. If there is a need for mocked dynamic class data, click "+ Add" to configure. The specific configuration instructions are as follows:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"FullClassName: The full class name of the local cache, such as java.lang.String."),(0,r.kt)("li",{parentName:"ul"},"MethodName: The method name to be mocked."),(0,r.kt)("li",{parentName:"ul"},'ParameterTypes: The full class names of all parameters, separated by "@". Primitive types can be abbreviated, such as int.')),(0,r.kt)("h3",{id:"replay-setting"},"Replay setting"),(0,r.kt)("p",null,"Select ",(0,r.kt)("strong",{parentName:"p"},"Replay")," tab to enter the replay settings page."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Case range"),'\uff1aSelect the duration for replaying the recorded cases of Continuous Integration (CI), and the unit of measurement is in "days".'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exclude Operation"),"\uff1aIf there are some paths that you don't want to compare, you can select \"",(0,r.kt)("strong",{parentName:"p"},"+ Add"),'" to add these paths to ignore. And then these paths will be skipped during replay, which will improve the success rate of replay.'),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u56de\u653e\u8bbe\u7f6e",src:n(5925).Z,width:"3237",height:"930"})),(0,r.kt)("h3",{id:"configure-with-yaml-file"},"Configure with Yaml file"),(0,r.kt)("p",null,"The above configuration for recording and replay can also be configured directly by importing Yaml configuration files."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u6587\u4ef6\u914d\u7f6e",src:n(130).Z,width:"3232",height:"1564"})),(0,r.kt)("h3",{id:"nodes-ignore"},"Nodes Ignore"),(0,r.kt)("p",null,"If there is data such as timestamp, random numbers, IPs in the response, even if the code does not change, there will be discrepancy points in the comparison result. In this case, you can pre-configure these nodes to be ignored to reduce interference."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u5ffd\u7565\u8282\u70b9",src:n(8851).Z,width:"1399",height:"838"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Global"),'\uff1aYou can add the global ignore nodes of this application, just select "',(0,r.kt)("strong",{parentName:"p"},"+"),'" to add the key to be ignored. Once you set, all the interfaces within this application will automatically skip the comparison of this node during replay.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Interfaces"),"\uff1aYou can add ignore nodes for individual interfaces under the application."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the edit icon",(0,r.kt)("img",{src:n(8799).Z,width:"23",height:"22"}),", enter the response returned from this interface request and select ",(0,r.kt)("strong",{parentName:"p"},"Save"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u7f16\u8f91\u54cd\u5e94\u4f53",src:n(1355).Z,width:"3136",height:"1679"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"All the nodes in the response will be displayed under this interface. Simply select the nodes you want to ignore."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u9009\u62e9\u8282\u70b9",src:n(6756).Z,width:"3129",height:"1474"})))),(0,r.kt)("h3",{id:"nodes-sort"},"Nodes Sort"),(0,r.kt)("p",null,"Usually, an array in the response contains multiple elements, and the order of elements in the responses returned from two different request URLs often differs, resulting in differences in comparison results even though the returned response are actually the same."),(0,r.kt)("p",null,"By configuring the keys of the elements in the array in ",(0,r.kt)("strong",{parentName:"p"},"Nodes Sort")," tab, we can avoid the failure of comparison due to different ordering of the elements in the array of the response during the matching process."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the edit icon",(0,r.kt)("img",{src:n(8799).Z,width:"23",height:"22"}),", enter the response from this interface manually, and select ",(0,r.kt)("strong",{parentName:"p"},"save"),"."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u7f16\u8f91\u54cd\u5e94\u4f53",src:n(2531).Z,width:"3157",height:"1687"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"After saving the response, the interface will automatically display all nodes of the response (only arrays can be sorted). Click the ",(0,r.kt)("strong",{parentName:"p"},"+"),' icon, select one or more keys under the array, and click "Save" to save. Take note, you may choose a key group that can uniquely identify the array element.'),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u9009\u62e9\u8282\u70b9",src:n(4155).Z,width:"2984",height:"1427"})),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u9009\u62e9\u8282\u70b9",src:n(9805).Z,width:"1503",height:"754"})),(0,r.kt)("p",{parentName:"li"},"And then AREX will no longer compare elements one by one in the order of the array elements during replay, but will find the same element in the two sets of response through the previously set key group and compare them one by one to avoid differences due to inconsistent element order."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"For example"),"\uff1aAs shown below, the ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," array contains multiple elements, and after the request is sent, the order of the two elements with ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," of ",(0,r.kt)("inlineCode",{parentName:"p"},"1")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," of ",(0,r.kt)("inlineCode",{parentName:"p"},"2")," in the return result is random. Without ",(0,r.kt)("strong",{parentName:"p"},"Nodes Sort"),", it will compare the first element in ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," array (the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"1"),") of recorede response with the first element in the same array (the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"2"),") of the replay response, resulting in a failue of replay."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Node order error",src:n(4704).Z,width:"1760",height:"1127"})),(0,r.kt)("p",{parentName:"li"},"So you need to check both ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," as the unique identifier of this ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," array element, and the same element will be found in the recorded and played back response messages by ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," for comparison during playback. If only ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," is checked as the identifier, the playback will still fail if there is an identical name."),(0,r.kt)("p",{parentName:"li"},"Similarly, the ",(0,r.kt)("inlineCode",{parentName:"p"},"phoneNumbers")," array in this array can be configured by checking ",(0,r.kt)("inlineCode",{parentName:"p"},"type"),"."),(0,r.kt)("p",{parentName:"li"},"In the response message shown below, the users array has multiple elements and their order of the two elements with ",(0,r.kt)("inlineCode",{parentName:"p"},"id=1")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"id=2")," is unpredictable after the request is sent. The first element in the response users array (with ",(0,r.kt)("inlineCode",{parentName:"p"},"id=1"),") is compared to the first element in the playback response users array (with ",(0,r.kt)("inlineCode",{parentName:"p"},"id=2"),"), leading to a replay failure."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"\u8282\u70b9\u987a\u5e8f\u9519\u8bef",src:n(4704).Z,width:"1760",height:"1127"})),(0,r.kt)("p",{parentName:"li"},"You should select both ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," as the unique identifier of this ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," array element, and the same element will be found in the recorded and replayed response messages by ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," for comparison during replay. If only ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," is selected as the identifier, there will still be differences in the comparison result in case of the same name, leading to a replay failure.."),(0,r.kt)("p",{parentName:"li"},"Similarly, the ",(0,r.kt)("inlineCode",{parentName:"p"},"phoneNumbers")," array in this array can be configured by selecting ",(0,r.kt)("inlineCode",{parentName:"p"},"type"),"."))))}h.isMDXComponent=!0},8799:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAWCAMAAAFrr8ehAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFBUExURSkpKSYmJhwcHBsbGyIiIioqKigoKDY2Nn5+foyMjI2NjYSEhE9PTyMjIycnJ0dHR9DQ0MrKysDAwMHBwcXFxX19fR0dHUtLS9jY2IqKijk5OUVFRURERENDQ11dXdTU1NbW1nl5eRgYGCUlJSQkJNPT04ODg0xMTNfX13x8fCsrK9XV1TAwMGhoaDExMYWFhdnZ2TMzM7KysqSkpDc3NyAgICwsLGZmZsfHx7GxsUpKSkhISNra2lFRUba2tsTExGJiYoaGhtvb283NzVtbW2BgYLW1tVVVVU1NTaurq6+vr6ysrElJSSEhIdzc3G5ubj8/P5iYmJqampmZmZSUlEJCQk5OTn9/fx4eHi4uLjU1NS0tLYeHhxcXF93d3Tg4OFNTU4iIiOnp6d7e3szMzM/Pz87Ozjo6OpGRkS8vLwAAAKUXIbYAAABrdFJOU/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AeJlF4QAAAAlwSFlzAAAV/QAAFf0BzXBRYQAAAOdJREFUKFNlUTGuxSAM65ATMHvhCJl6hKozM0hUuf8Znh3Qb6WfAoldJ0HhMLPDbl+eu9rM7dPhdLU4kbk+CaQB7aJjDLnL0yUyp9nhPrdRaKiWPCb/8EAQbsDc1iBgeCLGGDEEXjtsl5rihwNMxlC8FSsu2Xrz5fzjz8LuK+6noTXF/sn1J0awdTy6OK+Wt6WewT8Tb6C+vItH7RrPNWrfujTE7KoD8n7mELOo8MvHzeGpKfn5qYOIS1UWr77kzctNotyFWR++rwo5g08dDpsPyYnR4MTZl6/T9lqez0S9rpZVMlqH2w+EVFCLOSIJ2wAAAABJRU5ErkJggg=="},130:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.importyaml-47b1ee2d74d6d2d7981d61ad58f3acd6.png"},8851:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodeignore-dd179c7ec70668d80b367ff3061f4f0d.png"},1355:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodeignore2-557d7fc65f596e13c7d2315c65b7f758.png"},6756:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodeignore3-9839722f2b77116c4e8903ecb278d3cb.png"},4704:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodesort1-68fd5348f82b4db54e435b4a27a235b5.png"},2531:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodesort2-9df079a6938cf2b08283aeb959930315.png"},4155:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodesort3-36131f0e08aa8fc554c1d62286d98d2b.png"},9805:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.nodesort4-6af0b86421c5add9d1eb5711b3b734f2.png"},4143:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.record.setting-75b774a08891439dd015983da51ccd12.png"},5925:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/c3.replay.set-919b94aa009dbeb21ca97f9ee70a76a6.png"}}]);