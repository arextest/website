"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[425],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>g});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=s(a),m=r,g=d["".concat(p,".").concat(m)]||d[m]||u[m]||l;return a?n.createElement(g,o(o({ref:t},c),{},{components:a})):n.createElement(g,o({ref:t},c))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,o=new Array(l);o[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=a[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},6045:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var n=a(7462),r=(a(7294),a(3905));const l={sidebar_position:1,title:"Quick Installation",keywords:["Regression Testing","Automation Testing","Traffic Replay"]},o=void 0,i={unversionedId:"chapter1/Quick Installation",id:"chapter1/Quick Installation",title:"Quick Installation",description:"Pre-preparation",source:"@site/docs/chapter1/Quick Installation.md",sourceDirName:"chapter1",slug:"/chapter1/Quick Installation",permalink:"/website/docs/chapter1/Quick Installation",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chapter1/Quick Installation.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Quick Installation",keywords:["Regression Testing","Automation Testing","Traffic Replay"]},sidebar:"tutorialSidebar",previous:{title:"Get Started",permalink:"/website/docs/category/get-started"},next:{title:"Custom Installation",permalink:"/website/docs/chapter1/Custom Installation"}},p={},s=[{value:"Pre-preparation",id:"pre-preparation",level:2},{value:"Install AREX",id:"install-arex",level:2},{value:"Next steps",id:"next-steps",level:2},{value:"Deploy AREX Agent",id:"deploy-arex-agent",level:3},{value:"Configure Java Parameters",id:"configure-java-parameters",level:4},{value:"With Configuration file",id:"with-configuration-file",level:4},{value:"Set JAVA_OPTS variable",id:"set-java_opts-variable",level:4},{value:"Local mode via ArexCli",id:"local-mode-via-arexcli",level:4},{value:"AREX Deployment Solutions",id:"arex-deployment-solutions",level:2},{value:"Deploy Single AREX Service",id:"deploy-single-arex-service",level:3},{value:"Deploy Multiple AREX Service",id:"deploy-multiple-arex-service",level:3},{value:"Deployment Process",id:"deployment-process",level:4},{value:"Update",id:"update",level:2}],c={toc:s},d="wrapper";function u(e){let{components:t,...l}=e;return(0,r.kt)(d,(0,n.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"pre-preparation"},"Pre-preparation"),(0,r.kt)("p",null,"Before you start with AREX, make sure you have the following tools installed:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Docker")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Docker Compose"),"."),(0,r.kt)("h2",{id:"install-arex"},"Install AREX"),(0,r.kt)("p",null,"To get started, you can install AREX with Docker."),(0,r.kt)("p",null,"First clone the ",(0,r.kt)("inlineCode",{parentName:"p"},"deployments")," repostiory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/arextest/deployments.git \ncd deployments\n")),(0,r.kt)("p",null,"Now you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose")," to start AREX."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose up -d\n")),(0,r.kt)("p",null,"After installation, all components including ",(0,r.kt)("strong",{parentName:"p"},"Front-End"),", ",(0,r.kt)("strong",{parentName:"p"},"Services"),", ",(0,r.kt)("strong",{parentName:"p"},"Database")," will be installed automatically, with only one instance of each component, as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ID"),(0,r.kt)("th",{parentName:"tr",align:null},"Number of Instance"),(0,r.kt)("th",{parentName:"tr",align:null},"Model Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/arextest/arex-replay-schedule"},"Schedule Service")),(0,r.kt)("td",{parentName:"tr",align:null},"A set of schedule APIs that provide replay send and retrieve all responses for comparison.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/arextest/arex-report"},"Replay Report Service")),(0,r.kt)("td",{parentName:"tr",align:null},"A set of report APIs that provide difference summaries and show the difference result details after the responses are compared.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/arextest/arex-storage"},"Storage Service")),(0,r.kt)("td",{parentName:"tr",align:null},"A set of remote storage APIs that provide ",(0,r.kt)("a",{parentName:"td",href:"https://github.com/arextest/arex-agent-java"},"Agent Hook Service")," to save records and get responses as mocks.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/arextest/arex-front-end"},"Front-End")),(0,r.kt)("td",{parentName:"tr",align:null},"A visual web site that provide entry to all operations in your ",(0,r.kt)("strong",{parentName:"td"},"AREX"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"MongoDB"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6570\u636e\u5b58\u50a8\u53ca\u914d\u7f6e\u7ba1\u7406\u6570\u636e\u5e93")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"6"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"Redis"),(0,r.kt)("td",{parentName:"tr",align:null},"\u9ad8\u901f\u56de\u653e\u7f13\u5b58")))),(0,r.kt)("p",null,"You can check the status and ports of each service by running the command ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose ps")," on the host running Docker."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"[~ deployments]# docker-compose ps   \nName            Command                           State         Ports \n------------------------------------------------------------------------------------------ \narex-front      docker-entrypoint.sh node  ...    Up      0.0.0.0:8088->8080/tcp \narex-mongodb    docker-entrypoint.sh --auth       Up      0.0.0.0:27017->27017/tcp \narex-redis      docker-entrypoint.sh --app ...    Up      0.0.0.0:6379->6379/tcp \narex-report     catalina.sh run                   Up      0.0.0.0:8090->8080/tcp \narex-schedule   catalina.sh run                   Up      0.0.0.0:8092->8080/tcp \narex-storage    catalina.sh run                   Up      0.0.0.0:8093\u21928080/tcp\n")),(0,r.kt)("p",null,"Check all service log:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cd deployments \ndocker-compose logs\n")),(0,r.kt)("p",null,"Check AREX logs:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose logs arex\n")),(0,r.kt)("p",null,"Check ",(0,r.kt)("strong",{parentName:"p"},"Schedule Service")," log:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose logs arex-schedule-service\n")),(0,r.kt)("p",null,"Check ",(0,r.kt)("strong",{parentName:"p"},"Report Service")," log:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose logs arex-report-service\n")),(0,r.kt)("p",null,"Check ",(0,r.kt)("strong",{parentName:"p"},"Storage Service")," log:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker-compose logs arex-storage-service\n")),(0,r.kt)("h2",{id:"next-steps"},"Next steps"),(0,r.kt)("h3",{id:"deploy-arex-agent"},"Deploy AREX Agent"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"AREX Agent")," is the core component for applications recording and replay. You can run AREX Agent by configuring ",(0,r.kt)("inlineCode",{parentName:"p"},"-javaagent")," to dynamically inject the agent into the JVM."),(0,r.kt)("p",null,"The operation of AREX Agent depends on the ",(0,r.kt)("strong",{parentName:"p"},"Storage Service")," of AREX.(",(0,r.kt)("a",{parentName:"p",href:"https://github.com/arextest/arex-storage"},"AREX storage service"),")\u3002"),(0,r.kt)("p",null,"First clone the ",(0,r.kt)("inlineCode",{parentName:"p"},"arex-agent-java")," repostiory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/arextest/arex-agent-java.git \ncd arex-agent-java \nmvn clean install\n")),(0,r.kt)("p",null,"Then you will get a new folder named ",(0,r.kt)("inlineCode",{parentName:"p"},"arex-agent-jar")," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"arex-agent-java")," folder, which contains two jar packages."),(0,r.kt)("p",null,"AREX Agent can be deployed by the different methods listed below:"),(0,r.kt)("h4",{id:"configure-java-parameters"},"Configure Java Parameters"),(0,r.kt)("p",null,"Set the host and port of the two dependent services:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"java -javaagent:/path/to/arex-agent-<version>.jar\n     -Darex.service.name=your-service-name\n     -Darex.storage.service.host=<storage.service.host:port> //(The host IP of `deployments` after deployment in docker and the port of AREX storage service)    \n     -jar your-application.jar\n")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"arex-agent.jar"),": the name of the jar package provided by AREX or compiled by yourself, note the modified path"),(0,r.kt)("li",{parentName:"ul"},"your-service-name: the name of your tested service, different names for different services"),(0,r.kt)("li",{parentName:"ul"},"your-application.jar: the jar package of your tested service"))),(0,r.kt)("h4",{id:"with-configuration-file"},"With Configuration file"),(0,r.kt)("p",null,"You can create a new configuration file ",(0,r.kt)("inlineCode",{parentName:"p"},"arex.agent.conf")," as shown below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-conf",metastring:'title="arex.agent.conf"',title:'"arex.agent.conf"'},"arex.service.name=your-service-name  \narex.storage.service.host=<storage.service.host:port> \n")),(0,r.kt)("p",null,"Then configure Agent by running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"java -javaagent:/path/to/arex-agent-<version>.jar     \n     -Darex.config.path=/path/to/arex.agent.conf     \n     -jar your-application.jar\n")),(0,r.kt)("h4",{id:"set-java_opts-variable"},"Set JAVA_OPTS variable"),(0,r.kt)("p",null,"You can deploy AREX Agent through Tomcat by configuring ",(0,r.kt)("inlineCode",{parentName:"p"},"catalina.sh")," file and set the ",(0,r.kt)("inlineCode",{parentName:"p"},"JAVA_OPTS")," variable, or you can configure it directly in the environment variables. Here is an example of how to do this on Linux:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"export JAVA_OPTS=-Djavaagent:/path/to/arex-agent.jar -Darex.storage.path=/path/to/arex.agent.conf\n")),(0,r.kt)("p",null,"You can then run Tomcat as usual. The AREX Agent will be automatically injected into the JVM and run when Tomcat starts."),(0,r.kt)("h4",{id:"local-mode-via-arexcli"},"Local mode via ArexCli"),(0,r.kt)("p",null,"Run the local mode with ArexCli:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"chmod 550 bin/arex-cli.sh \ncd ./bin/ \n./arex-cli\n")),(0,r.kt)("p",null,"You can also run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'git clone https://github.com/arextest/arex-agent-java.git \ncd arex-agent-java \nmvn clean install \njava -cp ".\n')),(0,r.kt)("p",null,"Successful execution:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://arextest.github.io/arex-doc/resource/arexcli.png",alt:"img"})),(0,r.kt)("p",null,"The supported commands:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"record"),": Record data or set the recording rate."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[option: -r/--rate]")," set record rate, default value 1, record once every 60 seconds"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[option: -c/--close]")," shut down record"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"replay"),": Replay and compare differences with the recorded data."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[option: -n/--num]")," replay numbers, default the latest 10"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"watch"),": Watch the replay results and differences."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[option: -r/--replayId]")," replay id, multiple are separated by spaces"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"debug"),": Debug specific cases locally."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[option: -r/--recordId]")," record id, required Option")))),(0,r.kt)("p",null,"Note: In local mode, AREX uses ",(0,r.kt)("a",{parentName:"p",href:"https://www.h2database.com/"},"H2")," as a local storage to save test data, and no longer relies on the storage service. In addition, you will not be able to use the AREX UI interface."),(0,r.kt)("h2",{id:"arex-deployment-solutions"},"AREX Deployment Solutions"),(0,r.kt)("h3",{id:"deploy-single-arex-service"},"Deploy Single AREX Service"),(0,r.kt)("p",null,"If the recording and replay environments, i.e. the production and test environments, can communicate with each other, you could just deploy one AREX service. As shown in the following diagram, data is recorded in the production environment, stored in AREX (Mongodb), and then replayed in the test environment."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u5355\u670d\u52a1",src:a(7369).Z,width:"1091",height:"403"})),(0,r.kt)("h3",{id:"deploy-multiple-arex-service"},"Deploy Multiple AREX Service"),(0,r.kt)("p",null,"If the production environment and the test environment cannot communicate with each other, i.e. the recording environment and the replay environment are isolated from each other and the test environment cannot access the database in the production environment, then multiple AREX services need to be deployed."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"\u591a\u670d\u52a1",src:a(7345).Z,width:"1398",height:"1277"})),(0,r.kt)("h4",{id:"deployment-process"},"Deployment Process"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Deploy AREX A in the production environment for recording on-line traffic in the production environment and storing it in AREX (Mongodb)."),(0,r.kt)("li",{parentName:"ol"},"Deploy AREX B in the test environment for replaying the recorded traffic in the test environment."),(0,r.kt)("li",{parentName:"ol"},"The DBA synchronizes the database data from AREX A to AREX B in a one-way manner."),(0,r.kt)("li",{parentName:"ol"},"AREX A records on-line traffic from the producion environment, while AREX B replays the traffic in the test environment.")),(0,r.kt)("h2",{id:"update"},"Update"),(0,r.kt)("p",null,"First, enter the path where the ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," file is located. You may need to manually stop all the dependent services before updating. For example, the configuration service has been removed in version 0.2.4, updating while the configuration service is still running will cause the update to fail."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cd deployments \ndocker-compose down -v\n")),(0,r.kt)("p",null,"Note: If you do not want to retain the original Mongodb data or logs, just delete the arex-data and arex-logs directories in the current running directory manually(please be careful, as deletion cannot be undone)."),(0,r.kt)("p",null,"Update the deployments repository by pulling the latest version and start AREX again by running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"git pull \ndocker-compose up -d\n")))}u.isMDXComponent=!0},7345:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/c1.multi.service-19e805603c833aafa2d471b1c9ac1d94.png"},7369:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/c1.single.service-e6f6757cf901cefc5af30787f93570f2.png"}}]);